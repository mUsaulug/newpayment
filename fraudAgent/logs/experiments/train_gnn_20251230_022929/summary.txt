2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | ======================================================================
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | SCRIPT: train_gnn
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | RUN ID: 20251230_022929
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | START TIME: 2025-12-30 02:29:29
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | ======================================================================
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | GNN FRAUD DETECTION TRAINING PIPELINE - OPTIMIZED
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | GraphSAGE-based fraud detection on transaction graphs
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | Target: 30-45 minute training time
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | Parameters: {
  "hidden_channels": 128,
  "num_layers": 3,
  "dropout": 0.3,
  "batch_size": 1024,
  "num_neighbors": [
    15,
    10
  ],
  "num_epochs": 15,
  "patience": 3,
  "learning_rate": 0.001,
  "target_recall": 0.85
}
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | [1] Loading graph data...
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   ✓ Train graph: 1,296,675 nodes, 2,382,782 edges
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   ✓ Test graph: 555,719 nodes, 1,061,320 edges
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   ✓ Node features: 10 dimensions
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   ✓ Train fraud ratio: 0.0058
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   ✓ Test fraud ratio: 0.0039
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | [2] Creating mini-batch loaders...
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   ✓ Train batches: 1014
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   ✓ Val batches: 254
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   ✓ Model built: 77,569 parameters
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn | [3] Training GNN model...
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   Device: cpu
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   Epochs: 15
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   Learning rate: 0.001
2025-12-30 02:29:29 | INFO     | fraud_ml.train_gnn |   Early stopping patience: 3
2025-12-30 02:30:05 | INFO     | fraud_ml.train_gnn |   Epoch 001 | Loss: 0.0010 | Val AUC: 0.9985 | Val F1: 0.8753
2025-12-30 02:30:05 | INFO     | fraud_ml.train_gnn |     → New best model! (AUC: 0.9985)
2025-12-30 02:30:36 | INFO     | fraud_ml.train_gnn |   Epoch 002 | Loss: 0.0004 | Val AUC: 0.9992 | Val F1: 0.8997
2025-12-30 02:30:36 | INFO     | fraud_ml.train_gnn |     → New best model! (AUC: 0.9992)
2025-12-30 02:31:44 | INFO     | fraud_ml.train_gnn |   Epoch 003 | Loss: 0.0004 | Val AUC: 0.9993 | Val F1: 0.9063
2025-12-30 02:31:44 | INFO     | fraud_ml.train_gnn |     → New best model! (AUC: 0.9993)
2025-12-30 02:32:28 | INFO     | fraud_ml.train_gnn |   Epoch 004 | Loss: 0.0003 | Val AUC: 0.9994 | Val F1: 0.9313
2025-12-30 02:32:28 | INFO     | fraud_ml.train_gnn |     → New best model! (AUC: 0.9994)
2025-12-30 02:33:14 | INFO     | fraud_ml.train_gnn |   Epoch 005 | Loss: 0.0003 | Val AUC: 0.9995 | Val F1: 0.9266
2025-12-30 02:33:14 | INFO     | fraud_ml.train_gnn |     → New best model! (AUC: 0.9995)
2025-12-30 02:33:49 | INFO     | fraud_ml.train_gnn |   Epoch 006 | Loss: 0.0003 | Val AUC: 0.9994 | Val F1: 0.9424
2025-12-30 02:34:26 | INFO     | fraud_ml.train_gnn |   Epoch 007 | Loss: 0.0003 | Val AUC: 0.9997 | Val F1: 0.9452
2025-12-30 02:34:26 | INFO     | fraud_ml.train_gnn |     → New best model! (AUC: 0.9997)
2025-12-30 02:37:10 | INFO     | fraud_ml.train_gnn |   Epoch 008 | Loss: 0.0002 | Val AUC: 0.9994 | Val F1: 0.9383
2025-12-30 02:40:48 | INFO     | fraud_ml.train_gnn |   Epoch 009 | Loss: 0.0002 | Val AUC: 0.9995 | Val F1: 0.9275
2025-12-30 02:46:48 | INFO     | fraud_ml.train_gnn |   Epoch 010 | Loss: 0.0002 | Val AUC: 0.9992 | Val F1: 0.9449
2025-12-30 02:46:48 | INFO     | fraud_ml.train_gnn |   Early stopping triggered at epoch 10
2025-12-30 02:46:48 | INFO     | fraud_ml.train_gnn |   ✓ Training complete! Best val AUC: 0.9997
2025-12-30 02:46:48 | INFO     | fraud_ml.train_gnn | [4] Final model evaluation...
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn |   ✓ Optimal threshold: 0.6069
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | 
============================================================
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | VALIDATION METRICS (Optimal Threshold)
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | ============================================================
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | AUC-ROC: 0.9992
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | AP (PR-AUC): 0.9825
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Precision: 0.9992
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Recall: 0.8503
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | F1-Score: 0.9188
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | 
Confusion Matrix:
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn |   TN: 257,804  FP: 1
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn |   FN: 229  TP: 1,301
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | 
============================================================
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | TEST METRICS (Final Holdout)
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | ============================================================
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | AUC-ROC: 0.9992
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | AP (PR-AUC): 0.9656
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Precision: 0.9867
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Recall: 0.7958
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | F1-Score: 0.8810
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | 
Confusion Matrix:
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn |   TN: 553,551  FP: 23
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn |   FN: 438  TP: 1,707
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | ============================================================

2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | [5] Saving model and artifacts...
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Artifact saved: C:\Users\monster\Desktop\PyhtonLesson\fraudAgent\models\gnn_fraud_model_20251230_024719.pt (GNN fraud detection model)
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Artifact saved: C:\Users\monster\Desktop\PyhtonLesson\fraudAgent\models\gnn_metrics_20251230_024719.json (GNN model metrics)
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Artifact saved: C:\Users\monster\Desktop\PyhtonLesson\fraudAgent\models\gnn_fraud_model_latest.pt (Latest GNN model)
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn |   ✓ All artifacts saved to C:\Users\monster\Desktop\PyhtonLesson\fraudAgent\models
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Metrics: {
  "final_test_auc": 0.9991963129895909,
  "final_test_recall": 0.7958041958041958,
  "final_test_precision": 0.9867052023121388,
  "final_test_f1": 0.8810322580645161,
  "optimal_threshold": 0.6068904995918274,
  "num_parameters": 77569
}
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | 
======================================================================
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | GNN TRAINING COMPLETE!
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | ======================================================================
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Model saved: C:\Users\monster\Desktop\PyhtonLesson\fraudAgent\models\gnn_fraud_model_20251230_024719.pt
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Test AUC: 0.9992
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Test Recall: 0.7958
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Test Precision: 0.9867
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | Optimal Threshold: 0.6069
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | ======================================================================
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | ======================================================================
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | STATUS: SUCCESS
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | DURATION: 1070.03 seconds (17.83 minutes)
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | METADATA: C:\Users\monster\Desktop\PyhtonLesson\fraudAgent\logs\experiments\train_gnn_20251230_022929\metadata.json
2025-12-30 02:47:19 | INFO     | fraud_ml.train_gnn | ======================================================================
