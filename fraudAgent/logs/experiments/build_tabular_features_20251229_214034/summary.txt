2025-12-29 21:40:34 | INFO     | fraud_ml.build_tabular_features | ======================================================================
2025-12-29 21:40:34 | INFO     | fraud_ml.build_tabular_features | SCRIPT: build_tabular_features
2025-12-29 21:40:34 | INFO     | fraud_ml.build_tabular_features | RUN ID: 20251229_214034
2025-12-29 21:40:34 | INFO     | fraud_ml.build_tabular_features | START TIME: 2025-12-29 21:40:34
2025-12-29 21:40:34 | INFO     | fraud_ml.build_tabular_features | ======================================================================
2025-12-29 21:40:34 | INFO     | fraud_ml.build_tabular_features | TABULAR FEATURE ENGINEERING PIPELINE
2025-12-29 21:40:34 | INFO     | fraud_ml.build_tabular_features | Parameters: {
  "train_file": "C:\\Users\\monster\\Desktop\\PyhtonLesson\\fraudAgent\\data\\raw\\fraudTrain.csv",
  "test_file": "C:\\Users\\monster\\Desktop\\PyhtonLesson\\fraudAgent\\data\\raw\\fraudTest.csv",
  "output_dir": "C:\\Users\\monster\\Desktop\\PyhtonLesson\\fraudAgent\\data\\processed"
}
2025-12-29 21:40:34 | INFO     | fraud_ml.build_tabular_features | 
[STEP 1] Loading datasets...
2025-12-29 21:40:40 | INFO     | fraud_ml.build_tabular_features | ✓ Train: 1,296,675 rows
2025-12-29 21:40:40 | INFO     | fraud_ml.build_tabular_features | ✓ Test: 555,719 rows
2025-12-29 21:40:40 | INFO     | fraud_ml.build_tabular_features | 
[STEP 2] Building TRAIN features...
2025-12-29 21:40:40 | INFO     | fraud_ml.build_tabular_features | 
============================================================
2025-12-29 21:40:40 | INFO     | fraud_ml.build_tabular_features | Building TRAIN features...
2025-12-29 21:40:40 | INFO     | fraud_ml.build_tabular_features | ============================================================
2025-12-29 21:40:40 | INFO     | fraud_ml.build_tabular_features | [1] Creating time features...
2025-12-29 21:40:41 | INFO     | fraud_ml.build_tabular_features |   ✓ Created 8 time features
2025-12-29 21:40:41 | INFO     | fraud_ml.build_tabular_features | [2] Creating amount features...
2025-12-29 21:40:41 | INFO     | fraud_ml.build_tabular_features |   ✓ Created 3 amount features
2025-12-29 21:40:41 | INFO     | fraud_ml.build_tabular_features | [3] Creating geo features...
2025-12-29 21:40:41 | INFO     | fraud_ml.build_tabular_features |   ✓ Created 4 geo features
2025-12-29 21:40:41 | INFO     | fraud_ml.build_tabular_features | [4] Creating behavioral/velocity features...
2025-12-29 21:40:43 | INFO     | fraud_ml.build_tabular_features |   ✓ Created 9 behavioral features (optimized, vectorized)
2025-12-29 21:40:43 | INFO     | fraud_ml.build_tabular_features | [5] Encoding categorical features...
2025-12-29 21:40:44 | INFO     | fraud_ml.build_tabular_features |   ✓ Encoded 5 categorical columns (TRAIN)
2025-12-29 21:40:44 | INFO     | fraud_ml.build_tabular_features |   ✓ Added merchant frequency encoding
2025-12-29 21:40:44 | INFO     | fraud_ml.build_tabular_features | [6] Selecting final feature set...
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features |   ✓ Final feature count: 34
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features |   ✓ Feature list: ['amt', 'lat', 'long', 'city_pop', 'merch_lat', 'merch_long', 'hour', 'dayofweek', 'day', 'month', 'year', 'is_weekend', 'is_night', 'age', 'amt_log', 'amt_zscore', 'distance_km', 'distance_log', 'city_pop_log', 'card_tx_count', 'time_since_last_tx', 'card_avg_amt', 'amt_deviation_from_card_avg', 'time_since_last_tx_log', 'card_tx_sequence', 'is_recent_active', 'amt_rolling_mean_3', 'amt_rolling_std_3', 'category_encoded', 'gender_encoded', 'state_encoded', 'amt_bucket_encoded', 'distance_bucket_encoded', 'merchant_freq']
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features | 
✓ Feature engineering complete!
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features |   Shape: (1296675, 34)
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features |   Fraud ratio: 0.0058
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features | 
[STEP 3] Building TEST features...
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features | 
============================================================
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features | Building TEST features...
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features | ============================================================
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features | [1] Creating time features...
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features |   ✓ Created 8 time features
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features | [2] Creating amount features...
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features |   ✓ Created 3 amount features
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features | [3] Creating geo features...
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features |   ✓ Created 4 geo features
2025-12-29 21:40:45 | INFO     | fraud_ml.build_tabular_features | [4] Creating behavioral/velocity features...
2025-12-29 21:40:46 | INFO     | fraud_ml.build_tabular_features |   ✓ Created 9 behavioral features (optimized, vectorized)
2025-12-29 21:40:46 | INFO     | fraud_ml.build_tabular_features | [5] Encoding categorical features...
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features |   ✓ Encoded 5 categorical columns (TEST)
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features |   ✓ Added merchant frequency encoding
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features | [6] Selecting final feature set...
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features |   ✓ Final feature count: 34
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features |   ✓ Feature list: ['amt', 'lat', 'long', 'city_pop', 'merch_lat', 'merch_long', 'hour', 'dayofweek', 'day', 'month', 'year', 'is_weekend', 'is_night', 'age', 'amt_log', 'amt_zscore', 'distance_km', 'distance_log', 'city_pop_log', 'card_tx_count', 'time_since_last_tx', 'card_avg_amt', 'amt_deviation_from_card_avg', 'time_since_last_tx_log', 'card_tx_sequence', 'is_recent_active', 'amt_rolling_mean_3', 'amt_rolling_std_3', 'category_encoded', 'gender_encoded', 'state_encoded', 'amt_bucket_encoded', 'distance_bucket_encoded', 'merchant_freq']
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features | 
✓ Feature engineering complete!
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features |   Shape: (555719, 34)
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features |   Fraud ratio: 0.0039
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features | 
[STEP 4] Saving features...
2025-12-29 21:43:35 | ERROR    | fraud_ml.build_tabular_features | Error occurred: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features | ======================================================================
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features | STATUS: FAILED
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features | DURATION: 180.89 seconds (3.01 minutes)
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features | METADATA: C:\Users\monster\Desktop\PyhtonLesson\fraudAgent\logs\experiments\build_tabular_features_20251229_214034\metadata.json
2025-12-29 21:43:35 | INFO     | fraud_ml.build_tabular_features | ======================================================================
